#!/bin/sh
echo "ğŸ” Running pre-push checks..."

# Run gitleaks to check for secrets before pushing
echo "ğŸ” Scanning for secrets with gitleaks..."
gitleaks protect --staged --verbose

if [ $? -ne 0 ]; then
  echo "âŒ Gitleaks detected potential secrets - push rejected"
  echo "If this is a false positive, you can bypass with: git push --no-verify"
  exit 1
fi

echo "âœ… No secrets detected"
echo "ğŸ—ï¸  Testing full build..."
pnpm build

if [ $? -eq 0 ]; then
  echo "âœ… Build successful - push allowed"
else
  echo "âŒ Build failed - push rejected"
  exit 1
fi